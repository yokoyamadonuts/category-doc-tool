# TDDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€spec-workflow-mcpã«çµ±åˆã•ã‚ŒãŸTDDï¼ˆTest-Driven Developmentï¼‰ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä½¿ç”¨æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [TDDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã¯](#tddãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã¯)
3. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
4. [ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè·µ](#ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè·µ)
5. [MCPãƒ„ãƒ¼ãƒ«ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](#mcpãƒ„ãƒ¼ãƒ«ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
6. [ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](#ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³)
7. [ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½](#ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½)
8. [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
9. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

## æ¦‚è¦

spec-workflow-mcpã®TDDçµ±åˆæ©Ÿèƒ½ã¯ã€Test-Driven Developmentã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å¼·åˆ¶ã—ã€ä»•æ§˜ã‹ã‚‰ãƒ†ã‚¹ãƒˆã€å®Ÿè£…ã¾ã§ã®å®Œå…¨ãªãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’æä¾›ã—ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- **3æ®µéšã®Quality Gates**: RED â†’ GREEN â†’ REFACTOR
- **è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: GoãŠã‚ˆã³PHPã®ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼çµ±åˆ
- **ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æ**: ãƒ©ã‚¤ãƒ³ãƒ»ãƒ–ãƒ©ãƒ³ãƒã‚«ãƒãƒ¬ãƒƒã‚¸ã®è‡ªå‹•è¨ˆæ¸¬
- **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£**: è¦ä»¶ â‡„ ãƒ†ã‚¹ãƒˆ â‡„ å®Ÿè£…ã®å®Œå…¨ãªè¿½è·¡
- **ç›£æŸ»ãƒ­ã‚°**: ã™ã¹ã¦ã®TDDæ´»å‹•ã®è¨˜éŒ²
- **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®TDDé€²æ—ç¢ºèª

## TDDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã¯

### Red-Green-Refactor (RGR)ã‚µã‚¤ã‚¯ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gate-A    â”‚  RED Phase
â”‚  å¤±æ•—ã™ã‚‹   â”‚  - ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ã
â”‚ ãƒ†ã‚¹ãƒˆã‚’æ›¸ã â”‚  - ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gate-B    â”‚  GREEN Phase
â”‚ æœ€å°é™ã®å®Ÿè£… â”‚  - ãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹ã™ã‚‹æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
â”‚  ã§ãƒ‘ã‚¹      â”‚  - ã‚«ãƒãƒ¬ãƒƒã‚¸é–¾å€¤ã‚’æº€ãŸã™
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gate-C    â”‚  REFACTOR Phase
â”‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°â”‚  - ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„
â”‚ + ãƒˆãƒ¬ãƒ¼ã‚¹    â”‚  - ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’ç¢ºç«‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  - ãƒ†ã‚¹ãƒˆãŒå¼•ãç¶šããƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
```

### Quality Gates

#### Gate-A (RED Phase)
- **ç›®çš„**: ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆé–‹ç™ºã®å¼·åˆ¶
- **æ¡ä»¶**:
  - å°‘ãªãã¨ã‚‚1ã¤ã®ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã™ã‚‹
  - ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ï¼ˆå®Ÿè£…ãŒã¾ã ãªã„ãŸã‚ï¼‰
- **æˆæœç‰©**: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆ

#### Gate-B (GREEN Phase)
- **ç›®çš„**: æœ€å°é™ã®å®Ÿè£…ã§ãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹
- **æ¡ä»¶**:
  - ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã™ã‚‹
  - ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒé–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ80%ï¼‰ä»¥ä¸Š
- **æˆæœç‰©**: ãƒ‘ã‚¹ã™ã‚‹ãƒ†ã‚¹ãƒˆ + å®Ÿè£…ã‚³ãƒ¼ãƒ‰

#### Gate-C (REFACTOR Phase)
- **ç›®çš„**: ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Šã¨ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç¢ºç«‹
- **æ¡ä»¶**:
  - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã‚‚ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã™ã‚‹
  - å®Œå…¨ãªãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒã‚§ãƒ¼ãƒ³ãŒå­˜åœ¨ã™ã‚‹
- **æˆæœç‰©**: æ”¹å–„ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ + ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆ

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–

spec-workflow-mcpã‚’åˆæœŸåŒ–ã™ã‚‹ã¨ã€TDDé–¢é€£ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ï¼š

```
.spec-workflow/
â”œâ”€â”€ tdd/                  # TDDãƒ‡ãƒ¼ã‚¿ä¿å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ {feature}/        # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿
â”‚   â”‚   â”œâ”€â”€ test-results.json
â”‚   â”‚   â”œâ”€â”€ gates.json
â”‚   â”‚   â””â”€â”€ trace.yaml
â”‚   â””â”€â”€ audit.log         # ç›£æŸ»ãƒ­ã‚°
â””â”€â”€ tdd-templates/        # ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
    â”œâ”€â”€ go-test-template.go.md
    â””â”€â”€ php-test-template.php.md
```

### 2. ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç¢ºèª

`.spec-workflow/tdd-templates/` ã§Goã¾ãŸã¯PHPã®ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¯ï¼š

- ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›¸ãæ–¹
- Arrange-Act-Assertãƒ‘ã‚¿ãƒ¼ãƒ³
- ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ä¾‹

ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè·µ

### ã‚¹ãƒ†ãƒƒãƒ—1: ä»•æ§˜æ›¸ã®ä½œæˆ

é€šå¸¸ã®spec-workflowã«å¾“ã£ã¦ã€Requirements â†’ Design â†’ Tasksã‚’ä½œæˆã—ã¾ã™ã€‚

**requirements.md**ã§REQ-*ã‚¢ãƒ³ã‚«ãƒ¼ã‚’ä½¿ç”¨ï¼š

```markdown
# æ©Ÿèƒ½è¦ä»¶

## <a id="REQ-AUTH-001"></a>ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æœ‰åŠ¹ãªèªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã€‚

- ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›
- èªè¨¼ãŒæˆåŠŸã™ã‚‹ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã‚‹
- ç„¡åŠ¹ãªèªè¨¼æƒ…å ±ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™
```

### ã‚¹ãƒ†ãƒƒãƒ—2: Gate-A - REDãƒ•ã‚§ãƒ¼ã‚º

#### 2.1 ãƒ†ã‚¹ãƒˆã‚’æ›¸ã

ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‚è€ƒã«ã€å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ï¼š

**Goä¾‹** (`tests/auth_test.go`):
```go
package auth_test

import (
    "testing"
    "myapp/auth"
)

// TEST-AUTH-001
// Verifies: REQ-AUTH-001
// Description: User can login with valid credentials
func TestUserLoginSuccess(t *testing.T) {
    // Arrange
    authService := auth.NewService()
    username := "testuser"
    password := "password123"

    // Act
    user, err := authService.Login(username, password)

    // Assert
    if err != nil {
        t.Fatalf("Expected no error, got %v", err)
    }
    if user == nil {
        t.Fatal("Expected user object, got nil")
    }
}
```

#### 2.2 ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆå¤±æ•—ã‚’ç¢ºèªï¼‰

MCPãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ï¼š

```javascript
run-tests({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  language: "go",
  testPaths: ["./tests"],
  coverageEnabled: false  // REDãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ä¸è¦
})
```

ã¾ãŸã¯ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ï¼š
```bash
go test -v ./tests
```

#### 2.3 Gate-Aã‚’æ¤œè¨¼

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "A",
  action: "validate",
  language: "go",
  testPaths: ["./tests"]
})
```

æˆåŠŸã™ã‚‹ã¨ã€ã‚²ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ`pending`ã§ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#### 2.4 Gate-Aã‚’æ‰¿èª

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "A",
  action: "approve",
  approver: "Your Name",
  rationale: "All tests written and fail as expected"
})
```

### ã‚¹ãƒ†ãƒƒãƒ—3: Gate-B - GREENãƒ•ã‚§ãƒ¼ã‚º

#### 3.1 æœ€å°é™ã®å®Ÿè£…ã‚’æ›¸ã

ãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹ã™ã‚‹æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ï¼š

**Goä¾‹** (`auth/service.go`):
```go
package auth

type User struct {
    Username string
}

type Service struct{}

func NewService() *Service {
    return &Service{}
}

func (s *Service) Login(username, password string) (*User, error) {
    // æœ€å°é™ã®å®Ÿè£…
    if username == "testuser" && password == "password123" {
        return &User{Username: username}, nil
    }
    return nil, errors.New("invalid credentials")
}
```

#### 3.2 ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãï¼‰

```javascript
run-tests({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  language: "go",
  testPaths: ["./tests"],
  coverageEnabled: true
})
```

#### 3.3 Gate-Bã‚’æ¤œè¨¼

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "B",
  action: "validate",
  language: "go",
  testPaths: ["./tests"],
  coverageThreshold: 80  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ80%
})
```

ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä¸è¶³ã—ã¦ã„ã‚‹å ´åˆã¯ã€è¿½åŠ ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦å†å®Ÿè¡Œã—ã¾ã™ã€‚

#### 3.4 Gate-Bã‚’æ‰¿èª

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "B",
  action: "approve",
  approver: "Your Name",
  rationale: "All tests pass with 95% coverage"
})
```

### ã‚¹ãƒ†ãƒƒãƒ—4: Gate-C - REFACTORãƒ•ã‚§ãƒ¼ã‚º

#### 4.1 ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ï¼š
- é‡è¤‡ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤
- å¤‰æ•°åã®æ”¹å–„
- é–¢æ•°ã®åˆ†å‰²
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### 4.2 å®Ÿè£…ã«ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 

```go
package auth

// Implements: REQ-AUTH-001
func (s *Service) Login(username, password string) (*User, error) {
    // ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸå®Ÿè£…
    if err := s.validateCredentials(username, password); err != nil {
        return nil, err
    }
    return s.createUser(username), nil
}

// Implements: REQ-AUTH-001
func (s *Service) validateCredentials(username, password string) error {
    // èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯
}
```

#### 4.3 ãƒ†ã‚¹ãƒˆã‚’å†å®Ÿè¡Œ

ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã‚‚ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

```javascript
run-tests({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  language: "go",
  testPaths: ["./tests"],
  coverageEnabled: true
})
```

#### 4.4 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’ç”Ÿæˆ

```javascript
generate-trace({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  testDir: "tests",
  implDir: "auth",
  language: "go"
})
```

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã‚’ç”Ÿæˆã—ã¾ã™ï¼š
- REQ-* ã‹ã‚‰ TEST-* ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°
- TEST-* ã‹ã‚‰ IMPL-* ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°
- å®Œå…¨ãªãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒã‚§ãƒ¼ãƒ³

#### 4.5 Gate-Cã‚’æ¤œè¨¼

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "C",
  action: "validate",
  language: "go",
  testPaths: ["./tests"]
})
```

#### 4.6 Gate-Cã‚’æ‰¿èª

```javascript
tdd-gate({
  projectPath: "/path/to/project",
  feature: "user-authentication",
  gate: "C",
  action: "approve",
  approver: "Your Name",
  rationale: "Refactored code, tests pass, traceability complete"
})
```

## MCPãƒ„ãƒ¼ãƒ«ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### run-tests

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€çµæœã‚’ä¿å­˜ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
```typescript
{
  projectPath: string;      // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®çµ¶å¯¾ãƒ‘ã‚¹
  feature: string;          // ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼åï¼ˆspecåã¨ä¸€è‡´ï¼‰
  language: "go" | "php";   // ãƒ†ã‚¹ãƒˆè¨€èª
  testPaths: string[];      // ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹
  coverageEnabled?: boolean; // ã‚«ãƒãƒ¬ãƒƒã‚¸æœ‰åŠ¹åŒ–ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: trueï¼‰
  timeout?: number;         // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆmsã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30000ï¼‰
}
```

**æˆ»ã‚Šå€¤**:
- `success`: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®æˆå¦
- `data`: ãƒ†ã‚¹ãƒˆçµæœï¼ˆç·æ•°ã€ãƒ‘ã‚¹æ•°ã€å¤±æ•—æ•°ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ç­‰ï¼‰
- `savedTo`: çµæœã®ä¿å­˜å…ˆ

### tdd-gate

Quality Gateã‚’æ¤œè¨¼ã¾ãŸã¯æ‰¿èª/æ‹’å¦ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
```typescript
{
  projectPath: string;
  feature: string;
  gate: "A" | "B" | "C";
  action: "validate" | "approve" | "reject";
  language?: "go" | "php";       // validateã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§å¿…é ˆ
  testPaths?: string[];          // validateã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§å¿…é ˆ
  coverageThreshold?: number;    // Gate-Bç”¨ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 80ï¼‰
  approver?: string;             // approve/rejectã§å¿…é ˆ
  rationale?: string;            // rejectã§å¿…é ˆ
  timeout?: number;
}
```

**æˆ»ã‚Šå€¤**:
- `success`: ã‚²ãƒ¼ãƒˆæ¤œè¨¼/æ‰¿èªã®æˆå¦
- `data`: ã‚²ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹
- `errors`: æ¤œè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆå¤±æ•—æ™‚ï¼‰

### generate-trace

ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
```typescript
{
  projectPath: string;
  feature: string;
  testDir: string;      // ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
  implDir: string;      // å®Ÿè£…ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
  language: "go" | "php";
}
```

**æˆ»ã‚Šå€¤**:
- `success`: ç”Ÿæˆã®æˆå¦
- `data`: ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚µãƒãƒªãƒ¼
  - `totalRequirements`: ç·è¦ä»¶æ•°
  - `fullyTracedRequirements`: å®Œå…¨ã«ãƒˆãƒ¬ãƒ¼ã‚¹ã•ã‚ŒãŸè¦ä»¶æ•°
  - `completionPercentage`: å®Œäº†ç‡
  - `gaps`: æ¬ ã‘ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆ/å®Ÿè£…ã®ãƒªã‚¹ãƒˆ
- `savedTo`: trace.yamlã®ä¿å­˜å…ˆ

## ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

#### Go
```go
// TEST-{ID}
// Verifies: REQ-{ID}
// Description: {èª¬æ˜}
func TestXxx(t *testing.T) {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
}
```

#### PHP
```php
// TEST-{ID}
// Verifies: REQ-{ID}
// Description: {èª¬æ˜}
public function testXxx(): void {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
}
```

### å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

#### Go
```go
// Implements: REQ-{ID}
func YourFunction() {
    // å®Ÿè£…ã‚³ãƒ¼ãƒ‰
}
```

#### PHP
```php
// Implements: REQ-{ID}
public function yourMethod() {
    // å®Ÿè£…ã‚³ãƒ¼ãƒ‰
}
```

### ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¦å‰‡

1. **TEST-ID**: ä¸€æ„ã®ãƒ†ã‚¹ãƒˆIDï¼ˆä¾‹: TEST-001, TEST-AUTH-001ï¼‰
2. **REQå‚ç…§**: `Verifies:`, `Covers:`, ã¾ãŸã¯ `Tests:` ã‚’ä½¿ç”¨å¯èƒ½
3. **IMPLå‚ç…§**: `Implements:` ã¾ãŸã¯ `IMPL:` ã‚’ä½¿ç”¨å¯èƒ½
4. **Description**: ãƒ†ã‚¹ãƒˆã®ç›®çš„ã‚’ç°¡æ½”ã«èª¬æ˜

## ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆ`http://localhost:ãƒãƒ¼ãƒˆç•ªå·`ï¼‰ã§TDDé€²æ—ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### åˆ©ç”¨å¯èƒ½ãªæƒ…å ±

1. **ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§**
   - å„ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ãƒ†ã‚¹ãƒˆçµæœ
   - ã‚²ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆpending/approved/rejectedï¼‰
   - æœ€çµ‚æ›´æ–°æ—¥æ™‚

2. **ã‚µãƒãƒªãƒ¼çµ±è¨ˆ**
   - ç·ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼æ•°
   - ãƒ†ã‚¹ãƒˆã‚ã‚Šãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼æ•°
   - ã‚²ãƒ¼ãƒˆåˆ¥åˆ†å¸ƒï¼ˆA/B/Cï¼‰

3. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒ“ãƒ¥ãƒ¼**
   - REQ â†’ TEST â†’ IMPL ã®ãƒã‚§ãƒ¼ãƒ³
   - æ¬ ã‘ã¦ã„ã‚‹ãƒªãƒ³ã‚¯ã®å¯è¦–åŒ–

4. **ç›£æŸ»ãƒ­ã‚°**
   - ã™ã¹ã¦ã®TDDæ´»å‹•ã®è¨˜éŒ²
   - ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ï¼ˆãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã€ã‚²ãƒ¼ãƒˆã€æ—¥ä»˜ã€ã‚¢ã‚¯ã‚¿ãƒ¼ï¼‰

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ

å¿…ãšå®Ÿè£…ã®å‰ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šï¼š
- è¦ä»¶ã®æ˜ç¢ºåŒ–
- è¨­è¨ˆã®æ”¹å–„
- ãƒã‚°ã®æ—©æœŸç™ºè¦‹

### 2. å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§é€²ã‚ã‚‹

ä¸€åº¦ã«å¤§é‡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ãšã€å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§é€²ã‚ã¾ã™ï¼š
- 1ã¤ã®è¦ä»¶ â†’ 1ã¤ã®ãƒ†ã‚¹ãƒˆ â†’ æœ€å°é™ã®å®Ÿè£…
- é »ç¹ã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- æ—©æœŸã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¾—ã‚‹

### 3. ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã‚’è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿œã˜ã¦ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã‚’è¨­å®šï¼š
- ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªã‚³ãƒ¼ãƒ‰: 95%ä»¥ä¸Š
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯: 80%ä»¥ä¸Š
- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£: 70%ä»¥ä¸Š

### 4. ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’ç¶­æŒ

ã™ã¹ã¦ã®è¦ä»¶ã«å¯¾ã—ã¦ï¼š
- å°‘ãªãã¨ã‚‚1ã¤ã®ãƒ†ã‚¹ãƒˆ
- å°‘ãªãã¨ã‚‚1ã¤ã®å®Ÿè£…
- æ˜ç¢ºãªã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

### 5. ç›£æŸ»ãƒ­ã‚°ã‚’æ´»ç”¨

ç›£æŸ»ãƒ­ã‚°ã‚’å®šæœŸçš„ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼š
- èª°ãŒã„ã¤ã‚²ãƒ¼ãƒˆã‚’æ‰¿èªã—ãŸã‹
- ãƒ†ã‚¹ãƒˆå¤±æ•—ã®å±¥æ­´
- ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æ¨ç§»

### 6. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’æã‚Œãªã„

Gate-Cãƒ•ã‚§ãƒ¼ã‚ºã§ç©æ¥µçš„ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼š
- ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã®ã§å®‰å¿ƒ
- ã‚³ãƒ¼ãƒ‰å“è³ªã®ç¶™ç¶šçš„æ”¹å–„
- æŠ€è¡“çš„è² å‚µã®å‰Šæ¸›

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: Gate-Aæ¤œè¨¼ãŒã€Œãƒ†ã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€ã§å¤±æ•—ã™ã‚‹

**A**: `testPaths`ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ï¼š
```javascript
// æ‚ªã„ä¾‹
testPaths: ["tests"]  // ç›¸å¯¾ãƒ‘ã‚¹ã®å ´åˆã¯ ./

// è‰¯ã„ä¾‹
testPaths: ["./tests"]
testPaths: ["./tests/feature"]
```

### Q: Gate-Bæ¤œè¨¼ãŒã‚«ãƒãƒ¬ãƒƒã‚¸ä¸è¶³ã§å¤±æ•—ã™ã‚‹

**A**: ä»¥ä¸‹ã‚’ç¢ºèªï¼š
1. ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã«ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã‹
2. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ã‚‹ã‹
3. ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª: `go tool cover -html=coverage.out`
4. å¿…è¦ã«å¿œã˜ã¦`coverageThreshold`ã‚’èª¿æ•´

### Q: ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç”Ÿæˆã§ã€Œè¦ä»¶ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€

**A**: requirements.mdã‚’ç¢ºèªï¼š
1. REQ-*ã‚¢ãƒ³ã‚«ãƒ¼ãŒæ­£ã—ã„å½¢å¼ã‹: `<a id="REQ-001"></a>`
2. ã‚¢ãƒ³ã‚«ãƒ¼IDã¨Verifies:ã‚³ãƒ¡ãƒ³ãƒˆãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹
3. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹

### Q: ãƒ†ã‚¹ãƒˆã¯å®Ÿè¡Œã•ã‚Œã‚‹ãŒçµæœãŒä¿å­˜ã•ã‚Œãªã„

**A**: ä»¥ä¸‹ã‚’ç¢ºèªï¼š
1. `.spec-workflow/tdd/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã™ã‚‹ã‹
2. æ›¸ãè¾¼ã¿æ¨©é™ãŒã‚ã‚‹ã‹
3. `feature`åãŒæ­£ã—ã„ã‹ï¼ˆspecåã¨ä¸€è‡´ï¼‰

### Q: Gate-Cæ¤œè¨¼ãŒã€Œãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ä¸å®Œå…¨ã€ã§å¤±æ•—ã™ã‚‹

**A**: trace.yamlã‚’ç¢ºèªï¼š
```bash
cat .spec-workflow/tdd/{feature}/trace.yaml
```

æ¬ ã‘ã¦ã„ã‚‹ãƒªãƒ³ã‚¯ã‚’ç‰¹å®šã—ï¼š
1. ãƒ†ã‚¹ãƒˆã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ`// Verifies: REQ-*`ï¼‰ã‚’è¿½åŠ 
2. å®Ÿè£…ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ`// Implements: REQ-*`ï¼‰ã‚’è¿½åŠ 
3. ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’å†ç”Ÿæˆ

### Q: PHP/Goãƒ†ã‚¹ãƒˆãŒã€Œã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€ã§å¤±æ•—ã™ã‚‹

**A**: ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼š
```bash
# Go
go version
go test -v

# PHP
phpunit --version
```

PATHãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## å‚è€ƒè³‡æ–™

- [Goãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](../.spec-workflow/tdd-templates/go-test-template.go.md)
- [PHPãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](../.spec-workflow/tdd-templates/php-test-template.php.md)
- [spec-workflow-mcpå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/pimzino/spec-workflow-mcp)

## ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆï¼š

1. ç›£æŸ»ãƒ­ã‚°ã‚’ç¢ºèª: `.spec-workflow/tdd/audit.log`
2. ã‚²ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª: `.spec-workflow/tdd/{feature}/gates.json`
3. GitHubã§issueã‚’å ±å‘Š: https://github.com/pimzino/spec-workflow-mcp/issues

---

**Happy TDD Coding! ğŸ§ª**
